<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.spc.dao.ClassApplicationDao" >
    <sql id="BASE_TABLE">
       ClassApplication
    </sql>

   <insert id="add" useGeneratedKeys="true" keyProperty="id" parameterType="com.spc.model.ClassApplicationDomain">
       insert  into
       <include refid="BASE_TABLE"/>
       (className,mainLecturer,teacherInfo,courseInfo,classTime,checked)
       values
       (#{className}, #{mainLecturer}, #{teacherInfo},#{courseInfo},#{classTime},#{checked})
   </insert>
    
    <select id="findall" resultType="com.spc.model.ClassApplicationDomain">
      select c.id, c.teaId ,c.checked,c.className,c.classTime,c.teacherInfo,c.courseInfo,c.mainLecturer,c.mydate,a.checkStr
      from ClassApplication c
      left join Application_Check a
      on c.checked = a.id
      <where>
          <if test="teaId != 88888888">
              and c.teaId=#{teaId}
          </if>
          <if test="className!=''">
              and c.className=#{className}
          </if>
      </where>
    </select>
    <select id="findallWithDate" resultType="com.spc.model.ClassApplicationDomain">
      select c.id, c.teaId ,c.checked,c.className,c.classTime,c.teacherInfo,c.courseInfo,c.mainLecturer,c.mydate,a.checkStr
      from ClassApplication c
      left join Application_Check a
      on c.checked = a.id
      <where>
          <if test="teaId!=88888888">
              and c.teaId=#{teaId}
          </if>
          <if test="className!=''">
              and c.className=#{className}
          </if>
          and cast(s.mydate as date) = #{date}
      </where>
    </select>

</mapper>
